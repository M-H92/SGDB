<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <script type="module" src="../../../scripts/sidebar/addSidebar.js"></script>
    <script type="module" src="../../../scripts/syntaxHighlighting.js"></script>
    <link rel="stylesheet" href="../../../ressources/style.css" />
  </head>

  <body>
    <main id="mainElement">
      <div style="display: flex; justify-content: space-between">
        <div>
          <div>Nom :</div>
          <div>Prénom :</div>
        </div>
        <div>Examen de base de données - Questionnaire A</div>
        <div>14/03/2025</div>
      </div>
      <h2>Modalités d'évaluation</h2>
      <p>
        Pour chaque question, cochez la bonne proposition (une réponse par
        question) <br />
        Chaque réponse correcte augmente votre score d' 1 point <br />
        Chaque réponse incorrecte diminue votre score de (1 / (nombre de réponse
        possible) - 1) <br />
        <i
          >Cad 2 propositions => +1 ou -1; 3 propositions => +1 ou -0,5; 4
          propositions => +1 ou -0,33...
        </i>
        <br />
        Reportez vos réponses sur la feuille de réponse annexe avec votre nom,
        prénom, identifiant du questionnaire (A, B,...) <br />
        Sur cette feuille annexe, notez uniquement le numéro de la réponse
        cochée.
      </p>
      <h2 id="qcm">Liste des questions</h2>
    </main>
  </body>
  <script>
    const QCMElement = [
      {
        id: "1",
        difficulte: 1,
        question:
          "Trouvez toutes les relations correspondant à une relation 1..1 (ou 0..1) dans ces propositions :",
        codeSnippets: [],
        propositions: [
          "1) praticien - patient",
          "2) patient - pesee",
          "3) patient - ingredient",
        ],
        reponses: [
          { texte: "Toutes les propositions.", valeur: false },
          { texte: "Aucune des propositions.", valeur: true },
          { texte: "Les propositions 1 et 2.", valeur: false },
          { texte: "Les propositions 2 et 3.", valeur: false },
          { texte: "Les propositions 1 et 3.", valeur: false },
        ],
        nbrReponseCorrecte: () => {
          return this.reponses.filter((p) => p.valeur === true).length;
        },
      },
      {
        id: "2",
        difficulte: 1,
        codeSnippets: [],
        question:
          "Trouvez toutes les relations correspondant à une relation 1..n (ou 0..n) dans ces propositions :",
        propositions: [
          "1) patient - praticien",
          "2) patient - objectif",
          "3) patient - pesee",
        ],
        reponses: [
          { texte: "Toutes les propositions.", valeur: false },
          { texte: "Aucune des propositions.", valeur: false },
          { texte: "Les propositions 1 et 2.", valeur: false },
          { texte: "Les propositions 2 et 3.", valeur: true },
          { texte: "Les propositions 1 et 3.", valeur: false },
        ],
        nbrReponseCorrecte: () => {
          return this.reponses.filter((p) => p.valeur === true).length;
        },
      },
      {
        id: "3",
        difficulte: 1,
        codeSnippets: [],
        question:
          "Trouvez toutes les relations correspondant à une relation n..ndans ces propositions :",
        propositions: [
          "1) patient - praticien",
          "2) patient - objectif",
          "3) patient - pesee",
        ],
        reponses: [
          { texte: "Toutes les propositions.", valeur: false },
          { texte: "Aucune des propositions.", valeur: false },
          { texte: "Uniquement la 1", valeur: true },
          { texte: "Uniquement la 2", valeur: false },
          { texte: "Uniquement la 3", valeur: false },
        ],
        nbrReponseCorrecte: () => {
          return this.reponses.filter((p) => p.valeur === true).length;
        },
      },
      {
        id: "4",
        difficulte: 1,
        codeSnippets: [],
        question:
          "Puis-je insérer deux ingrédients avec le même nom (par exemple, deux record 'carotte')",
        propositions: [],
        reponses: [
          {
            texte: "Oui",
            valeur: true,
          },
          {
            texte: "Non",
            valeur: false,
          },
        ],
        nbrReponseCorrecte: () => {
          return this.reponses.filter((p) => p.valeur === true).length;
        },
      },
      {
        id: "5",
        difficulte: 1,
        codeSnippets: [],
        question:
          "Est-ce que deux patient peuvent avoir le même nom et prénom (par exemple, deux 'Marie Dupont')",
        propositions: [],
        reponses: [
          { texte: "Oui", valeur: true },
          { texte: "Non", valeur: false },
        ],
        nbrReponseCorrecte: () => {
          return this.reponses.filter((p) => p.valeur === true).length;
        },
      },
      {
        id: "6",
        difficulte: 1,
        codeSnippets: [],
        question:
          "Sur base du schéma uniquement, un objectif peut-il avoir une date de début plus récente que sa date de fin?",
        propositions: [],
        reponses: [
          { texte: "Oui", valeur: true },
          { texte: "Non", valeur: false },
        ],
        nbrReponseCorrecte: () => {
          return this.reponses.filter((p) => p.valeur === true).length;
        },
      },
      {
        id: "7",
        difficulte: 1,
        codeSnippets: [],
        question:
          "Laquelle de ces conditions permet de récupérer un patient dont l'inscription n'est plus valide?",
        propositions: [],
        reponses: [
          { texte: "Aucune des propositions suivantes.", valeur: false },
          { texte: "Toutes les propositions suivantes.", valeur: false },
          {
            texte: "WHERE patient.validite_inscription is null",
            valeur: false,
          },
          { texte: "WHERE praticien.fin_contrat < CURRENT_DATE", valeur: true },
        ],
        nbrReponseCorrecte: () => {
          return this.reponses.filter((p) => p.valeur === true).length;
        },
      },
      {
        id: "8",
        difficulte: 1,
        codeSnippets: [],
        question: "Laquelle de ces PK est auto incrémentée",
        propositions: [],
        reponses: [
          { texte: "Aucune des propositions.", valeur: true },
          { texte: "Toutes les suivante.", valeur: false },
          { texte: "praticien_patient.id_patient", valeur: false },
          { texte: "praticien_patient.id_praticien", valeur: false },
        ],
        nbrReponseCorrecte: () => {
          return this.reponses.filter((p) => p.valeur === true).length;
        },
      },
      {
        id: "9",
        difficulte: 1,
        codeSnippets: [],
        question:
          "Sous quelle condition deux pesées peuvent-elle être faite le même jour?",
        propositions: [],
        reponses: [
          { texte: "Jamais, la date faisant partie de la PK", valeur: false },
          {
            texte: "Toujours, il n'y a pas de restriction l'empêchant",
            valeur: false,
          },
          {
            texte: "Oui, sous condition que le patient soit différent",
            valeur: true,
          },
          {
            texte:
              "Oui, sous condition que la valeur (la donnée de la colonne valeur) soit différente",
            valeur: false,
          },
        ],
        nbrReponseCorrecte: () => {
          return this.reponses.filter((p) => p.valeur === true).length;
        },
      },
      {
        id: "10",
        difficulte: 1,
        codeSnippets: [],
        question: "Pour une PK, laquelle de ces propositions est fausse",
        propositions: [],
        reponses: [
          { texte: "Une PK doit être une valeur unique", valeur: false },
          { texte: "Une table ne peut avoir qu'une PK", valeur: true },
          {
            texte: "Une PK est requise pour chaque table",
            valeur: true,
          },
        ],
        nbrReponseCorrecte: () => {
          return this.reponses.filter((p) => p.valeur === true).length;
        },
      },
      {
        id: "11",
        difficulte: 1,
        codeSnippets: [
          `-- A
      CREATE DATABASE clinique_du_poids;`,
          `-- B
      CREATE DATABASE clinique_du_poids(EMPTY);`,
          `-- C
      CREATE DATABASE clinique_du_poids(
      	TABLE praticien,
      	TABLE patient,
      	-- code omis par clarté
      );`,
          `-- D
      CREATE DATABASE clinique_du_poids
        WITH TABLES(
      	TABLE praticien,
      	-- code omis par clarté
        )
      );`,
        ],
        question:
          "Sélectionnez la requête valide pour créer une base de données",
        propositions: [],
        reponses: [
          { texte: "Aucune des propositions.", valeur: false },
          { texte: "A", valeur: true },
          { texte: "B", valeur: false },
          { texte: "C", valeur: false },
          { texte: "D", valeur: false },
        ],
        nbrReponseCorrecte: () => {
          return this.reponses.filter((p) => p.valeur === true).length;
        },
      },
      {
        id: "12",
        difficulte: 1,
        codeSnippets: [
          `CREATE TABLE patient(
    id BIGINT PRIMARY KEY,
    validite_inscription DATE NOT NULL
);`,
        ],
        question: "Quel est le résultat de cette requête?",
        propositions: [],
        reponses: [
          { texte: "Réussite, la table est créée", valeur: true },
          { texte: "Erreur, les types sont mal définits", valeur: false },
          {
            texte:
              "Erreur, impossible de définir une PK à la création de la table",
            valeur: false,
          },
          {
            texte: "Aucune des autres propositions",
            valeur: false,
          },
        ],
        nbrReponseCorrecte: () => {
          return this.reponses.filter((p) => p.valeur === true).length;
        },
      },
      {
        id: "13",
        difficulte: 1,
        codeSnippets: [
          `CREATE TABLE pesee(
    id_patient INTEGER NOT NULL,
    date_pesee DATE NOT NULL,
    valeur DECIMAL(8, 2) NOT NULL
);
ALTER TABLE
    pesee ADD PRIMARY KEY(id_patient, date_pesee);`,
        ],
        question: "Quel est le résultat de cette requête?",
        propositions: [],
        reponses: [
          { texte: "Réussite, la table est créée", valeur: true },
          { texte: "Erreur, les types sont mal définits", valeur: false },
          {
            texte: "Erreur, impossible de définir une PK sur deux champs",
            valeur: false,
          },
          {
            texte:
              "Erreur, la PK doit être définie dans la requête de création de la table",
            valeur: false,
          },
        ],
        nbrReponseCorrecte: () => {
          return this.reponses.filter((p) => p.valeur === true).length;
        },
      },
      {
        id: "14",
        difficulte: 1,
        codeSnippets: [],
        question:
          "Considérant les relations décrites sur le schéma, quel effet aura la suppression de la table info_personelle sur la table patient",
        propositions: [],
        reponses: [
          { texte: "Aucune des propositions.", valeur: false },
          {
            texte: "Pas d'impacte",
            valeur: true,
          },
          {
            texte:
              "Suppression de toutes les données de la table patient par 'cascade'",
            valeur: false,
          },
          {
            texte:
              "Suppression des patient de la table patient par 'cascade', mais uniquement si ils disposent de données dans la table info_personnelle",
            valeur: false,
          },
        ],
        nbrReponseCorrecte: () => {
          return this.reponses.filter((p) => p.valeur === true).length;
        },
      },
      {
        id: "15",
        difficulte: 1,
        codeSnippets: [
          `-- A
CREATE TABLE ingredient(
  id BIGINT PRIMARY KEY,
  -- reste des colonnes
); `,
          `-- B
CREATE TABLE ingredient(
  id BIGINT,
  -- reste des colonnes
  PRIMARY KEY(id)
);`,
          `-- C
CREATE TABLE ingredient(
  id BIGINT,
  -- reste des colonnes
);
ALTER TABLE ingredient
ADD PRIMARY KEY(id);`,
        ],
        question: "Laquelle des propositions suivante est correcte",
        propositions: [],
        reponses: [
          {
            texte:
              "Toutes les requêtes présentées permettent de créer la table ingredient et sa PK",
            valeur: true,
          },
          {
            texte:
              "Aucune des requêtes présentées ne permettent de créer la table ingredient et sa PK",
            valeur: false,
          },
          {
            texte: "La requête A permet de créer la table ingredient et sa PK",
            valeur: false,
          },
          {
            texte: "La requête B permet de créer la table ingredient et sa PK",
            valeur: false,
          },
          {
            texte: "La requête C permet de créer la table ingredient et sa PK",
            valeur: false,
          },
          {
            texte:
              "La requête A ainsi que la C permettent de créer la table ingredient et sa PK",
            valeur: false,
          },
        ],
        nbrReponseCorrecte: () => {
          return this.reponses.filter((p) => p.valeur === true).length;
        },
      },
      {
        id: "15",
        difficulte: 1,
        codeSnippets: [
          `-- A
CREATE TABLE ingredient(
  id BIGINT PRIMARY KEY,
  -- reste des colonnes
); `,
          `-- B
CREATE TABLE ingredient(
  id BIGINT,
  -- reste des colonnes
  PRIMARY KEY(id)
);`,
          `-- C
CREATE TABLE ingredient(
  id BIGINT,
  -- reste des colonnes
);
ALTER TABLE ingredient
ADD PRIMARY KEY(id);`,
        ],
        question: "Laquelle des propositions suivante est correcte",
        propositions: [],
        reponses: [
          {
            texte:
              "Toutes les requêtes présentées permettent de créer la table ingredient et sa PK",
            valeur: true,
          },
          {
            texte:
              "Aucune des requêtes présentées ne permettent de créer la table ingredient et sa PK",
            valeur: false,
          },
          {
            texte: "La requête A permet de créer la table ingredient et sa PK",
            valeur: false,
          },
          {
            texte: "La requête B permet de créer la table ingredient et sa PK",
            valeur: false,
          },
          {
            texte: "La requête C permet de créer la table ingredient et sa PK",
            valeur: false,
          },
          {
            texte:
              "La requête A ainsi que la C permettent de créer la table ingredient et sa PK",
            valeur: false,
          },
        ],
        nbrReponseCorrecte: () => {
          return this.reponses.filter((p) => p.valeur === true).length;
        },
      },
      {
        id: "16",
        difficulte: 1,
        codeSnippets: [`INSERT INTO patient VALUES (1, '09-09-2024');`],
        question:
          "Considérant la table patient et info_personnelle comme vide, quel est le résultat de cette requête?",
        propositions: [],
        reponses: [
          {
            texte: "Aucune des propositions ci-dessous",
            valeur: false,
          },
          {
            texte:
              "Réussite, un patient un enregistrement est créé dans la table patient",
            valeur: true,
          },
          {
            texte:
              "Échec, la contrainte de clé étrangère n'est pas respectée avec info_personnelle",
            valeur: false,
          },
          {
            texte:
              "Échec, la syntaxe n'est pas bonne, il est nécessaire de renseigner les noms des colonnes impactées",
            valeur: false,
          },
        ],
        nbrReponseCorrecte: () => {
          return this.reponses.filter((p) => p.valeur === true).length;
        },
      },
      {
        id: "17",
        difficulte: 1,
        codeSnippets: [
          `-- A
INSERT INTO patient VALUES (2, '09-09-2024');`,
          `-- B
INSERT INTO patient (id, validite_inscription) VALUES  (2, '09-09-2024');`,
        ],
        question:
          "Considérant la table patient et info_personnelle comme vide, laquelle de ces deux requêtes permet d'insérer un enregistrement dans la table patient?",
        propositions: [],
        reponses: [
          {
            texte: "Aucune des propositions ci-dessous",
            valeur: false,
          },
          {
            texte: "Les deux requêtes",
            valeur: true,
          },
          {
            texte: "La requête A uniquement",
            valeur: false,
          },
          {
            texte: "La requête B uniquement",
            valeur: false,
          },
        ],
        nbrReponseCorrecte: () => {
          return this.reponses.filter((p) => p.valeur === true).length;
        },
      },

      {
        id: "18",
        difficulte: 1,
        codeSnippets: [`INSERT INTO patient (id) VALUES  (3);`],
        question:
          "Considérant la table patient et info_personnelle comme vide, quel sera le résultat de cette requête?",
        propositions: [],
        reponses: [
          {
            texte:
              "Réussite, un enregistrement est ajouté dans la table patient",
            valeur: false,
          },
          {
            texte:
              "Échec, aucun n'enregistrement n'est ajouté dans la table patient",
            valeur: true,
          },
        ],
        nbrReponseCorrecte: () => {
          return this.reponses.filter((p) => p.valeur === true).length;
        },
      },
      {
        id: "19",
        difficulte: 1,
        codeSnippets: [`SELECT * FROM objectif WHERE id_patient = 4;`],
        question:
          "Considérant la table patient comme vide, quel sera le résultat de cette requête?",
        propositions: [],
        reponses: [
          {
            texte: "La requête s'exécute correctement",
            valeur: true,
          },
          {
            texte: "La requête retourne une erreur",
            valeur: false,
          },
        ],
        nbrReponseCorrecte: () => {
          return this.reponses.filter((p) => p.valeur === true).length;
        },
      },
      {
        id: "20",
        difficulte: 1,
        codeSnippets: [
          `SELECT * FROM objectif WHERE id_patient = 5 AND id_patient = 6;`,
        ],
        question:
          "Considérant que la base de données contient des informations pour les patients d'id 5 et 6, quel sera le résultat de cette requête?",
        propositions: [],
        reponses: [
          {
            texte:
              "Les données des objectifs des patients 5 et 6 sont récupérées",
            valeur: true,
          },
          {
            texte:
              "Les données des objectifs des patients 5 et 6 NE SONT PAS récupérées",
            valeur: true,
          },
        ],
        nbrReponseCorrecte: () => {
          return this.reponses.filter((p) => p.valeur === true).length;
        },
      },
      {
        id: "21",
        difficulte: 1,
        codeSnippets: [
          `-- A
  SELECT * FROM patient
  LEFT JOIN info_personnelle
	ON id = id_patient;`,
          `-- B
  SELECT * FROM patient
  RIGHT JOIN info_personnelle
	ON id = id_patient;`,
          `-- C
  SELECT * FROM patient
  INNER JOIN info_personnelle
	ON id = id_patient;`,
          `-- D
  SELECT * FROM patient
  JOIN info_personnelle
	ON id = id_patient;`,
        ],
        question:
          "Je souhaite récupérer toutes les informations de la table patient ainsi que les informations de la table info_personnelle si elles existent, quelle requête utiliser parmis les suivantes",
        propositions: [],
        reponses: [
          {
            texte: "Toutes ces requêtes retournent l'information demandée",
            valeur: false,
          },
          {
            texte:
              "Aucune de ces requêtes ne retournent l'information demandée",
            valeur: false,
          },
          {
            texte: "La requête A retourne l'information demandée",
            valeur: true,
          },
          {
            texte: "La requête B retourne l'information demandée",
            valeur: false,
          },
          {
            texte: "La requête C retourne l'information demandée",
            valeur: false,
          },
          {
            texte: "La requête D retourne l'information demandée",
            valeur: false,
          },
        ],
        nbrReponseCorrecte: () => {
          return this.reponses.filter((p) => p.valeur === true).length;
        },
      },
      {
        id: "22",
        difficulte: 1,
        codeSnippets: [
          `-- A
SELECT * from patient
INNER JOIN info_personnelle
ON patient.id = info_personnelle.id_patient
WHERE validite_inscription < CURRENT_DATE `,
          `-- B
SELECT * from patient
LEFT JOIN info_personnelle
ON patient.id = info_personnelle.id_patient
WHERE validite_inscription < CURRENT_DATE `,
          `-- C
SELECT * from patient
RIGHT JOIN info_personnelle
ON patient.id = info_personnelle.id_patient
WHERE validite_inscription > CURRENT_DATE`,
          `-- D
SELECT * from patient
RIGHT JOIN info_personnelle
ON patient.id = info_personnelle.id_patient
WHERE validite_inscription > CURRENT_DATE`,
        ],
        question:
          "Je souhaite récupérer les adresse mail des patients pour lesquelles la date de validite d'inscription est dépassée. Si un patient n'a pas renseigné d'information personnelles, je ne souhaite pas qu'il soit compris dans les résultats. Quelle requête utiliser parmis les suivantes",
        propositions: [],
        reponses: [
          {
            texte: "Toutes ces requêtes retournent l'information demandée",
            valeur: false,
          },
          {
            texte:
              "Aucune de ces requêtes ne retournent l'information demandée",
            valeur: false,
          },
          {
            texte: "La requête A retourne l'information demandée",
            valeur: true,
          },
          {
            texte: "La requête B retourne l'information demandée",
            valeur: false,
          },
          {
            texte: "La requête C retourne l'information demandée",
            valeur: false,
          },
          {
            texte: "La requête D retourne l'information demandée",
            valeur: false,
          },
        ],
        nbrReponseCorrecte: () => {
          return this.reponses.filter((p) => p.valeur === true).length;
        },
      },
      {
        id: "22",
        difficulte: 1,
        codeSnippets: [
          `SELECT info_personnelle.nom, 
	info_personnelle.prenom, 
	validite_inscription, 
	praticien.nom, 
	praticien.prenom 
FROM praticien_patient
JOIN patient 
	ON patient.id = praticien_patient.id_patient
JOIN praticien
	ON praticien.id = praticien_patient.id_praticien
JOIN info_personnelle
	ON patient.id = info_personnelle.id_patient;`,
        ],
        question:
          "Je souhaite récupérer les noms et prénoms des patients, la date de validite de leur inscription ainsi que les noms et prenom des praticiens qui s'occupent de ces patients. Considérant que je ne souhaite pas d'enregistrement pour lesquelles il manquerait l'une de ces informations, est-ce que cette requête satisfait ma demande?",
        propositions: [],
        reponses: [
          {
            texte:
              "Oui, cette requête retourne les informations demandées (et uniquement les informations demandées)",
            valeur: true,
          },
          {
            texte:
              "Non, cette requête ne retourne pas les informations demandées (ou pas toutes les informations demandéées)",
            valeur: false,
          },
        ],
        nbrReponseCorrecte: () => {
          return this.reponses.filter((p) => p.valeur === true).length;
        },
      },
    ];

    const QCMElementSet = new Set(QCMElement.map((e) => e.id));
    if (QCMElementSet.size != QCMElement.length)
      console.error("duplicata dans les id du qcm");

    function populateBody() {
      const main = document.getElementById("qcm");
      let renumerotation = 24;
      QCMElement.sort((a, b) => (+a > +b ? 1 : -1)).forEach((e) => {
        const hr = document.createElement("hr");
        hr.style.width = "75%";
        hr.style.marginTop = "16px";
        hr.style.marginBottom = "24px";
        // main.after(hr);
        const element = document.createElement("p");
        element.id = `question-${e.id}`;
        element.textContent = `${renumerotation}) ${e.question}`;
        main.after(element);
        renumerotation--;
        const ul = document.createElement("ul");
        ul.id = `proposition-${e.id}`;

        const propositions = e.propositions.forEach((p) => {
          let prop = document.createElement("li");
          prop.textContent = p;
          ul.appendChild(prop);
        });
        element.after(ul);

        const codeWrapper = document.createElement("div");
        codeWrapper.id = `code-snippets-${e.id}`;
        codeWrapper.classList.add("container");

        e.codeSnippets.forEach((c) => {
          let pre = document.createElement("pre");
          pre.textContent = c;
          pre.classList.add("code-snippet");
          pre.classList.add("block");
          codeWrapper.appendChild(pre);
        });
        element.after(codeWrapper);

        const fieldset = document.createElement("fieldset");
        fieldset.id = `fieldset-${e.id}`;
        const legend = document.createElement("legend");
        if (e.nbrReponseCorrecte === 1)
          legend.textContent = "Choisir une unique réponse";
        else legend.textContent = "Choisir une ou plusieurs réponse(s)";

        let i = 1;
        e.reponses.forEach((r) => {
          const div = document.createElement("div");
          const reponse = document.createElement("input");
          reponse.type = "checkbox";
          reponse.id = `answer-${i}-${e.id}`;
          reponse.name = e.id;
          const label = document.createElement("label");
          label.textContent = `${i}) ${r.texte}`;
          label.htmlFor = reponse.id;
          div.appendChild(reponse);
          div.appendChild(label);
          fieldset.appendChild(div);
          i++;
        });
        ul.after(fieldset);
      });
    }
    populateBody();
  </script>

  <style>
    * {
      font-size: 0.95em;
    }
  </style>
</html>
